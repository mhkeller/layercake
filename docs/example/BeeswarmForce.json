{"main":{"title":"+page.svelte","contents":"<script>\n  import { LayerCake, Svg, Html } from 'layercake';\n  import { scaleOrdinal } from 'd3-scale';\n\n  import Key from './_components/Key.html.svelte';\n  import AxisX from './_components/AxisX.svelte';\n  import Beeswarm from './_components/BeeswarmForce.svelte';\n\n  // This example loads csv data as json using @rollup/plugin-dsv\n  import data from './_data/us-senate.csv';\n\n  const xKey = 'date_of_birth';\n  const zKey = 'gender';\n  const titleKey = 'name';\n\n  const r = 6;\n\n  const seriesColors = ['#fc0', '#000'];\n\n  const dataTransformed = data.map(d => {\n    return {\n      [titleKey]: d[titleKey],\n      [zKey]: d[zKey],\n      [xKey]: +d[xKey].split('-')[0]\n    };\n  });\n</script>\n\n<div class=\"chart-container\">\n  <LayerCake\n    padding={{ bottom: 15 }}\n    x={xKey}\n    z={zKey}\n    zScale={scaleOrdinal()}\n    zRange={seriesColors}\n    data={dataTransformed}\n    let:width\n  >\n    <Svg>\n      <AxisX />\n      <Beeswarm\n        r={width < 400 ? r / 1.25 : r}\n        strokeWidth={1}\n        xStrength={0.95}\n        yStrength={0.075}\n        getTitle={d => d[titleKey]}\n      />\n    </Svg>\n\n    <Html pointerEvents={false}>\n      <Key shape=\"circle\" />\n    </Html>\n  </LayerCake>\n</div>\n\n<style>\n  /*\n    The wrapper div needs to have an explicit width and height in CSS.\n    It can also be a flexbox child or CSS grid element.\n    The point being it needs dimensions since the <LayerCake> element will\n    expand to fill it.\n  */\n  .chart-container {\n    width: 100%;\n    height: 250px;\n  }\n</style>"},"dek":"A Beeswarm chart using a statically generated D3 force layout with a technique from <a href=\"https://twitter.com/anmccartney\" target=\"_blank\" rel=\"noreferrer\">@anmccartney</a>. For a non-force layout Beeswarm <a href=\"/example/Beeswarm\" target=\"_blank\" rel=\"noreferrer\">see this example</a>. For another way of doing a D3 force layout, see the <a href=\"/example/CirclePackForce\" target=\"_blank\" rel=\"noreferrer\">Circle Pack Force example</a>.\n\nThis chart is an example of using the slot prop `let: width` to set a dynamic circle radius based on the chart's width.\n","components":[{"title":"./_components/Key.html.svelte","contents":"<!--\n  @component\n  Creates a key for ordinal scales on `zScale`.\n -->\n<script>\n  import { getContext } from 'svelte';\n\n  /** @type {String} [shape='square'] - The shape for each item. Can be 'circle', 'line', or 'square'; */\n  export let shape = 'square';\n\n  /** @type {String} [align='start'] - Sets the CSS flexbox justify-content setting for the box as a whole. Can be 'start', 'center' or 'end'. */\n  export let align = 'start';\n\n  /** @type {Function|Object|undefined} [lookup] - Either a function that takes the value and returns a formatted string, or an object of values. If a given value is not present in a lookup object, it returns the original value. */\n  export let lookup = undefined;\n\n  /** @type {Boolean} [capitalize=true] - Capitalize the first character. */\n  export let capitalize = true;\n\n  const { zDomain, zScale } = getContext('LayerCake');\n\n  function cap(val) {\n    return String(val).replace(/^\\w/, d => d.toUpperCase());\n  }\n\n  function displayName(val) {\n    if (lookup) {\n      return typeof lookup === 'function' ? lookup(val) : lookup[val] || val;\n    }\n    return capitalize === true ? cap(val) : val;\n  }\n</script>\n\n<div class=\"key\" style=\"justify-content: {align === 'end' ? 'flex-end' : align};\">\n  {#each $zDomain as item}\n    <div class=\"key-item\">\n      <div\n        class=\"chip chip__{shape}\"\n        style=\"background: {shape === `line`\n          ? `linear-gradient(-45deg, #ffffff 40%, ${$zScale(item)} 41%, ${$zScale(item)} 59%, #ffffff 60%)`\n          : $zScale(item)};\"\n      ></div>\n      <div class=\"name\">{displayName(item)}</div>\n    </div>\n  {/each}\n</div>\n\n<style>\n  .key {\n    display: flex;\n  }\n  .key-item {\n    margin-right: 14px;\n  }\n  .chip {\n    display: inline-block;\n    position: relative;\n    width: 12px;\n    height: 12px;\n  }\n  .chip__circle {\n    border-radius: 50%;\n  }\n  .chip__line:after {\n    content: '';\n    position: absolute;\n    border-width: 3px;\n    width: 14px;\n    transform: rotate(-45deg);\n    transform-origin: 14px 5px;\n  }\n  .name {\n    display: inline;\n    font-size: 14px;\n    text-shadow:\n      -1px -1px 0 #fff,\n      1px -1px 0 #fff,\n      -1px 1px 0 #fff,\n      1px 1px 0 #fff;\n  }\n</style>"},{"title":"./_components/AxisX.svelte","contents":"<!--\n  @component\n  Generates an SVG x-axis. This component is also configured to detect if your x-scale is an ordinal scale. If so, it will place the markers in the middle of the bandwidth.\n -->\n<script>\n  import { getContext } from 'svelte';\n\n  const { width, height, xScale, yRange } = getContext('LayerCake');\n\n  /** @type {Boolean} [tickMarks=false] - Show a vertical mark for each tick. */\n  export let tickMarks = false;\n\n  /** @type {Boolean} [gridlines=true] - Show gridlines extending into the chart area. */\n  export let gridlines = true;\n\n  /** @type {Number} [tickMarkLength=6] - The length of the tick mark. */\n  export let tickMarkLength = 6;\n\n  /** @type {Boolean} [baseline=false] – Show a solid line at the bottom. */\n  export let baseline = false;\n\n  /** @type {Boolean} [snapLabels=false] - Instead of centering the text labels on the first and the last items, align them to the edges of the chart. */\n  export let snapLabels = false;\n\n  /** @type {Function} [format=d => d] - A function that passes the current tick value and expects a nicely formatted value in return. */\n  export let format = d => d;\n\n  /** @type {Number|Array|Function} [ticks] - If this is a number, it passes that along to the [d3Scale.ticks](https://github.com/d3/d3-scale) function. If this is an array, hardcodes the ticks to those values. If it's a function, passes along the default tick values and expects an array of tick values in return. If nothing, it uses the default ticks supplied by the D3 function. */\n  export let ticks = undefined;\n\n  /** @type {Number} [tickGutter=0] - The amount of whitespace between the start of the tick and the chart drawing area (the yRange min). */\n  export let tickGutter = 0;\n\n  /** @type {Number} [dx=0] - Any optional value passed to the `dx` attribute on the text label. */\n  export let dx = 0;\n\n  /** @type {Number} [dy=12] - Any optional value passed to the `dy` attribute on the text label. */\n  export let dy = 12;\n\n  function textAnchor(i, sl) {\n    if (sl === true) {\n      if (i === 0) {\n        return 'start';\n      }\n      if (i === tickVals.length - 1) {\n        return 'end';\n      }\n    }\n    return 'middle';\n  }\n\n  $: tickLen = tickMarks === true ? tickMarkLength ?? 6 : 0;\n\n  $: isBandwidth = typeof $xScale.bandwidth === 'function';\n\n  $: tickVals = Array.isArray(ticks)\n    ? ticks\n    : isBandwidth\n      ? $xScale.domain()\n      : typeof ticks === 'function'\n        ? ticks($xScale.ticks())\n        : $xScale.ticks(ticks);\n\n  $: halfBand = isBandwidth ? $xScale.bandwidth() / 2 : 0;\n</script>\n\n<g class=\"axis x-axis\" class:snapLabels>\n  {#each tickVals as tick, i (tick)}\n    {#if baseline === true}\n      <line class=\"baseline\" y1={$height} y2={$height} x1=\"0\" x2={$width} />\n    {/if}\n\n    <g class=\"tick tick-{i}\" transform=\"translate({$xScale(tick)},{Math.max(...$yRange)})\">\n      {#if gridlines === true}\n        <line class=\"gridline\" x1={halfBand} x2={halfBand} y1={-$height} y2=\"0\" />\n      {/if}\n      {#if tickMarks === true}\n        <line\n          class=\"tick-mark\"\n          x1={halfBand}\n          x2={halfBand}\n          y1={tickGutter}\n          y2={tickGutter + tickLen}\n        />\n      {/if}\n      <text x={halfBand} y={tickGutter + tickLen} {dx} {dy} text-anchor={textAnchor(i, snapLabels)}\n        >{format(tick)}</text\n      >\n    </g>\n  {/each}\n</g>\n\n<style>\n  .tick {\n    font-size: 11px;\n  }\n\n  line,\n  .tick line {\n    stroke: #aaa;\n    stroke-dasharray: 2;\n  }\n\n  .tick text {\n    fill: #666;\n  }\n\n  .tick .tick-mark,\n  .baseline {\n    stroke-dasharray: 0;\n  }\n  /* This looks slightly better */\n  .axis.snapLabels .tick:last-child text {\n    transform: translateX(3px);\n  }\n  .axis.snapLabels .tick.tick-0 text {\n    transform: translateX(-3px);\n  }\n</style>"},{"title":"./_components/BeeswarmForce.svelte","contents":"<!--\n  @component\n  Generates an SVG Beeswarm chart using a [d3-force simulation](https://github.com/d3/d3-force).\n -->\n<script>\n  import { getContext } from 'svelte';\n  import { forceSimulation, forceX, forceY, forceCollide } from 'd3-force';\n\n  const { data, xGet, height, zGet } = getContext('LayerCake');\n\n  const nodes = $data.map(d => ({ ...d }));\n\n  /** @type {Number} [r=4] - The circle radius size in pixels. */\n  export let r = 4;\n\n  /** @type {Number} [strokeWidth=1] - The circle's stroke width in pixels. */\n  export let strokeWidth = 1;\n\n  /** @type {String} [stroke='#fff'] - The circle's stroke color. */\n  export let stroke = '#fff';\n\n  /** @type {Number} [xStrength=0.95] - The value passed into the `.strength` method on `forceX`. See [the documentation](https://github.com/d3/d3-force#x_strength). */\n  export let xStrength = 0.95;\n\n  /** @type {Number} [yStrength=0.075] - The value passed into the `.strength` method on `forceY`. See [the documentation](https://github.com/d3/d3-force#y_strength). */\n  export let yStrength = 0.075;\n\n  /** @type {Function|undefined} [getTitle] — An accessor function to get the field on the data element to display as a hover label using a `<title>` tag. */\n  export let getTitle = undefined;\n\n  $: simulation = forceSimulation(nodes)\n    .force(\n      'x',\n      forceX()\n        .x(d => $xGet(d))\n        .strength(xStrength)\n    )\n    .force(\n      'y',\n      forceY()\n        .y($height / 2)\n        .strength(yStrength)\n    )\n    .force('collide', forceCollide(r))\n    .stop();\n\n  $: {\n    for (\n      let i = 0,\n        n = Math.ceil(Math.log(simulation.alphaMin()) / Math.log(1 - simulation.alphaDecay()));\n      i < n;\n      ++i\n    ) {\n      simulation.tick();\n    }\n  }\n</script>\n\n<g class=\"bee-group\">\n  {#each simulation.nodes() as node}\n    <circle fill={$zGet(node)} {stroke} stroke-width={strokeWidth} cx={node.x} cy={node.y} {r}>\n      {#if getTitle}\n        <title>{getTitle(node)}</title>\n      {/if}\n    </circle>\n  {/each}\n</g>"}],"modules":[],"componentModules":[],"componentComponents":[],"csvs":[{"title":"./_data/us-senate.csv","contents":"state_name,party,name,gender,date_of_birth\r\nAlaska,R,Daniel Sullivan,male,1964-11-13\r\nAlaska,R,Lisa Murkowski,female,1957-05-22\r\nAlabama,D,Gordon Jones,male,1954-05-04\r\nAlabama,R,Richard Shelby,male,1934-05-06\r\nArkansas,R,John Boozman,male,1950-12-10\r\nArkansas,R,Tom Cotton,male,1977-05-13\r\nArizona,D,Kyrsten Sinema,female,1976-07-12\r\nArizona,R,Martha McSally,female,1966-03-22\r\nCalifornia,D,Dianne Feinstein,female,1933-06-22\r\nCalifornia,D,Kamala Harris,female,1964-10-20\r\nColorado,R,Cory Gardner,male,1974-08-22\r\nColorado,D,Michael Bennet,male,1964-11-28\r\nConnecticut,D,Christopher Murphy,male,1973-08-03\r\nConnecticut,D,Richard Blumenthal,male,1946-02-13\r\nDelaware,D,Christopher Coons,male,1963-09-09\r\nDelaware,D,Thomas Carper,male,1947-01-23\r\nFlorida,R,Rick Scott,male,1952-12-01\r\nFlorida,R,Marco Rubio,male,1971-05-28\r\nGeorgia,R,David Perdue,male,1949-12-10\r\nGeorgia,R,Johnny Isakson,male,1944-12-28\r\nHawaii,D,Brian Schatz,male,1972-10-20\r\nHawaii,D,Mazie Hirono,female,1947-11-03\r\nIowa,R,Joni Ernst,female,1970-07-01\r\nIllinois,D,Richard Durbin,male,1944-11-21\r\nIdaho,R,James Risch,male,1943-05-03\r\nIllinois,D,Tammy Duckworth,female,1968-03-12\r\nIndiana,R,Todd Young,male,1972-08-24\r\nKansas,R,Jerry Moran,male,1954-05-29\r\nKansas,R,Pat Roberts,male,1936-04-20\r\nKentucky,R,Mitch McConnell,male,1942-02-20\r\nKentucky,R,Rand Paul,male,1963-01-07\r\nLouisiana,R,Bill Cassidy,male,1957-09-28\r\nLouisiana,R,John Kennedy,male,1951-11-21\r\nMassachusetts,D,Edward Markey,male,1946-11-11\r\nMassachusetts,D,Elizabeth Warren,female,1949-06-22\r\nMaryland,D,Benjamin Cardin,male,1943-10-05\r\nMaryland,D,Chris Van Hollen,male,1959-01-10\r\nMaine,I,Angus King,male,1944-03-31\r\nMaine,R,Susan Collins,female,1952-12-07\r\nMichigan,D,Debbie Stabenow,female,1950-04-29\r\nMichigan,D,Gary Peters,male,1958-01-01\r\nMinnesota,D,Tina Smith,female,1958-03-04\r\nMinnesota,D,Amy Klobuchar,female,1960-05-25\r\nMissouri,R,Josh Hawley,male,1979-12-31\r\nIndiana,R,Mike Braun,male,1954-03-24\r\nMississippi,R,Roger Wicker,male,1951-07-05\r\nMississippi,R,Cindy Hyde-Smith,female,1959-05-10\r\nIowa,R,Charles Grassley,male,1933-09-17\r\nMontana,R,Steve Daines,male,1962-08-20\r\nIdaho,R,Mike Crapo,male,1951-05-20\r\nMissouri,R,Roy Blunt,male,1950-01-10\r\nNorth Dakota,R,Kevin Cramer,male,1961-01-21\r\nNorth Dakota,R,John Hoeven,male,1957-03-13\r\nMontana,D,Jon Tester,male,1956-08-21\r\nNorth Carolina,R,Richard Burr,male,1955-11-30\r\nNorth Carolina,R,Thom Tillis,male,1960-08-30\r\nNebraska,R,Ben Sasse,male,1972-02-22\r\nNebraska,R,Deb Fischer,female,1951-03-01\r\nNew Hampshire,D,Jeanne Shaheen,female,1947-01-28\r\nNew Hampshire,D,Margaret Hassan,female,1958-02-27\r\nNew Jersey,D,Cory Booker,male,1969-04-27\r\nNew Jersey,D,Robert Menendez,male,1954-01-01\r\nNew Mexico,D,Martin Heinrich,male,1971-10-17\r\nNew Mexico,D,Tom Udall,male,1948-05-18\r\nNevada,D,Catherine Cortez-Masto,female,1964-03-29\r\nNevada,D,Jacky Rosen,female,1957-08-02\r\nNew York,D,Charles Schumer,male,1950-11-23\r\nNew York,D,Kirsten Gillibrand,female,1966-12-09\r\nOhio,R,Rob Portman,male,1955-12-19\r\nOhio,D,Sherrod Brown,male,1952-11-09\r\nOklahoma,R,James Inhofe,male,1934-11-17\r\nOklahoma,R,James Lankford,male,1968-03-04\r\nOregon,D,Jeff Merkley,male,1956-10-24\r\nOregon,D,Ron Wyden,male,1949-05-03\r\nPennsylvania,R,Patrick Toomey,male,1961-11-17\r\nPennsylvania,D,Robert Casey,male,1960-04-13\r\nRhode Island,D,Jack Reed,male,1949-11-12\r\nRhode Island,D,Sheldon Whitehouse,male,1955-10-20\r\nSouth Carolina,R,Lindsey Graham,male,1955-07-09\r\nSouth Carolina,R,Tim Scott,male,1965-09-19\r\nSouth Dakota,R,John Thune,male,1961-01-07\r\nSouth Dakota,R,Mike Rounds,male,1954-10-24\r\nTennessee,R,Marsha Blackburn,female,1952-06-06\r\nTennessee,R,Lamar Alexander,male,1940-07-03\r\nTexas,R,John Cornyn,male,1952-02-02\r\nTexas,R,Ted Cruz,male,1970-12-22\r\nUtah,R,Mike Lee,male,1971-06-04\r\nUtah,R,Mitt Romney,male,1947-03-12\r\nVirginia,D,Mark Warner,male,1954-12-15\r\nVirginia,D,Tim Kaine,male,1958-02-26\r\nVermont,I,Bernard Sanders,male,1941-09-08\r\nVermont,D,Patrick Leahy,male,1940-03-31\r\nWashington,D,Maria Cantwell,female,1958-10-13\r\nWashington,D,Patty Murray,female,1950-10-11\r\nWisconsin,R,Ron Johnson,male,1955-04-08\r\nWisconsin,D,Tammy Baldwin,female,1962-02-11\r\nWest Virginia,D,Joe Manchin,male,1947-08-24\r\nWest Virginia,R,Shelley Capito,female,1953-11-26\r\nWyoming,R,John Barrasso,male,1952-07-21\r\nWyoming,R,Michael Enzi,male,1944-02-01"}],"jsons":[]}