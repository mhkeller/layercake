import{e as k,a as D,t as y}from"./disclose-version.CmtI0EPl.js";import{p as $,t as x,a as B,v as g,w as O,P as C}from"./runtime.B3Do0ZXm.js";import{i as z}from"./lifecycle.B5gl02A_.js";import{p as d}from"./index-client.CfugqxwE.js";import{d as I,t as J}from"./downloadBlob.DPn4pLDi.js";import{u as L}from"./Brush.html.DSgXU-YJ.js";var M=y('<button title="download zip file" class="icon svelte-lkwcax" style="background-image: url(/icons/download.svg)">Download &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</button>');function A(c,n){$(n,!1);let s=d(n,"data",24,()=>({})),m=d(n,"slug",8),w=d(n,"ssr",8,!1),i=C(!1);function b(a=""){return(a.match(/from\s'(.+)'?/gm)||[]).map(p=>p.replace(/(from |'|"|;)/g,"")).filter(p=>!p.startsWith("."))}const f=[s().main,...s().components,...s().componentComponents].reduce((a,e)=>a.concat(b(e.contents)),[]).reduce((a,e)=>(a.includes(e)||a.push(e),a),[]);async function v(){g(i,!0);const a=new Date().getTime(),e=await(await window.fetch(`/svelte-app.json?${a}`)).json(),r=await(await window.fetch(`/deps.json?${a}`)).json();if(f.length>0){const t=e.findIndex(({path:o})=>o==="package.json"),u=JSON.parse(e[t].data),h={},j={};f.forEach(o=>{o!=="svelte"&&(h[o]=r[o],r[o]||window.alert(`Missing dependency, add "${o}" to this repo's package.json`))}),Object.assign(u.dependencies,h),Object.assign(u.devDependencies,j),e[t].data=JSON.stringify(u,null,"  ")}e.push(...s().components.map(t=>({path:`src/routes/${t.title.replace("./","")}`,data:t.contents}))),e.push(...s().modules.map(t=>({path:`src/routes/${t.title.replace("./","")}`,data:t.contents}))),e.push(...s().componentModules.map(t=>({path:`src/routes/${t.title.replace("../","")}`,data:t.contents}))),e.push(...s().componentComponents.map(t=>({path:`src/routes/${t.title}`,data:t.contents}))),e.push(...s().csvs.map(t=>({path:`src/routes/${t.title.replace("../","")}`,data:t.contents}))),e.push(...s().jsons.map(t=>({path:`src/routes/${t.title.replace("../","")}`,data:t.contents}))),e.push({path:"src/routes/+page.svelte",data:s().main.contents});const p=L(e.filter(Boolean),"path",!1);I(J(p),`layercake-${w()?"ssr-":""}${m()}.zip`),g(i,!1)}z();var l=M();x(()=>l.disabled=O(i)),k("click",l,v),D(c,l),B()}function E(c){const n=c.split("/"),s=n[n.length-1].split(".");return s.pop(),s.join(".").toLowerCase()}export{A as D,E as c};
