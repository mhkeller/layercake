import{j as v,a as k,t as D}from"./disclose-version.DBj9Vt0q.js";import{p as y,r as $,a as x,h as B,m as O,s as h}from"./runtime.D9nQNyi8.js";import{i as C}from"./lifecycle.fbi-k1SI.js";import{p as g}from"./index-client.CFCBblPQ.js";import{d as z,t as I}from"./downloadBlob.DPn4pLDi.js";import{u as J}from"./Brush.html.Bk-i1qZL.js";var L=D('<button title="download zip file" class="icon svelte-lkwcax" style="background-image: url(/icons/download.svg)">Download &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</button>');function A(p,n){y(n,!1);let s=g(n,"data",8,()=>({})),u=g(n,"ssr",0,!1),r=O(!1);function w(a=""){return(a.match(/from\s'(.+)'?/gm)||[]).map(c=>c.replace(/(from |'|"|;)/g,"")).filter(c=>!c.startsWith("."))}const m=[s().main,...s().components,...s().componentComponents].reduce((a,e)=>a.concat(w(e.contents)),[]).reduce((a,e)=>(a.includes(e)||a.push(e),a),[]);async function b(){h(r,!0);const a=new Date().getTime(),e=await(await window.fetch(`/svelte-app.json?${a}`)).json(),l=await(await window.fetch(`/deps.json?${a}`)).json();if(m.length>0){const t=e.findIndex(({path:o})=>o==="package.json"),d=JSON.parse(e[t].data),f={},j={};m.forEach(o=>{o!=="svelte"&&(f[o]=l[o],l[o]||window.alert(`Missing dependency, add "${o}" to this repo's package.json`))}),Object.assign(d.dependencies,f),Object.assign(d.devDependencies,j),e[t].data=JSON.stringify(d,null,"  ")}e.push(...s().components.map(t=>({path:`src/routes/${t.title.replace("./","")}`,data:t.contents}))),e.push(...s().modules.map(t=>({path:`src/routes/${t.title.replace("./","")}`,data:t.contents}))),e.push(...s().componentModules.map(t=>({path:`src/routes/${t.title.replace("../","")}`,data:t.contents}))),e.push(...s().componentComponents.map(t=>({path:`src/routes/${t.title}`,data:t.contents}))),e.push(...s().csvs.map(t=>({path:`src/routes/${t.title.replace("../","")}`,data:t.contents}))),e.push(...s().jsons.map(t=>({path:`src/routes/${t.title.replace("../","")}`,data:t.contents}))),e.push({path:"src/routes/+page.svelte",data:s().main.contents});const c=J(e.filter(Boolean),"path",!1);z(I(c),`layercake-${u()?"ssr-":""}${n.slug}.zip`),h(r,!1)}C();var i=L();$(()=>i.disabled=B(r)),v("click",i,b,!1),k(p,i),x()}function E(p){const n=p.split("/"),s=n[n.length-1].split(".");return s.pop(),s.join(".").toLowerCase()}export{A as D,E as c};
