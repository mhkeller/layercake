import{s as _,e as k,t as D,c as v,b as x,d as B,f as m,u as g,A as O,i as C,h as S,y as T,n as w}from"./scheduler.BuUXzzgF.js";import{S as N,i as q}from"./index.BbJvc9HH.js";import{d as z,t as A}from"./downloadBlob.BMcR_dZe.js";import{u as E}from"./Brush.html.DhsUzaVt.js";function I(l){let t,o,e,p;return{c(){t=k("button"),o=D("Download      "),this.h()},l(c){t=v(c,"BUTTON",{title:!0,class:!0,style:!0});var i=x(t);o=B(i,"Download      "),i.forEach(m),this.h()},h(){t.disabled=l[0],g(t,"title","download zip file"),g(t,"class","icon svelte-1gef78k"),O(t,"background-image","url(/icons/download.svg)")},m(c,i){C(c,t,i),S(t,o),e||(p=T(t,"click",l[1]),e=!0)},p(c,[i]){i&1&&(t.disabled=c[0])},i:w,o:w,d(c){c&&m(t),e=!1,p()}}}function J(l=""){return(l.match(/from\s'(.+)'?/gm)||[]).map(e=>e.replace(/(from |'|"|;)/g,"")).filter(e=>!e.startsWith("."))}function L(l,t,o){let{data:e={}}=t,{slug:p}=t,{ssr:c=!1}=t,i=!1;const d=[e.main,...e.components,...e.componentComponents].reduce((n,a)=>n.concat(J(a.contents)),[]).reduce((n,a)=>(n.includes(a)||n.push(a),n),[]);async function b(){o(0,i=!0);const n=new Date().getTime(),a=await(await window.fetch(`/svelte-app.json?${n}`)).json(),f=await(await window.fetch(`/deps.json?${n}`)).json();if(d.length>0){const s=a.findIndex(({path:r})=>r==="package.json"),u=JSON.parse(a[s].data),h={},y={};d.forEach(r=>{r!=="svelte"&&(h[r]=f[r],f[r]||window.alert(`Missing dependency, add "${r}" to this repo's package.json`))}),Object.assign(u.dependencies,h),Object.assign(u.devDependencies,y),a[s].data=JSON.stringify(u,null,"  ")}a.push(...e.components.map(s=>({path:`src/routes/${s.title.replace("./","")}`,data:s.contents}))),a.push(...e.modules.map(s=>({path:`src/routes/${s.title.replace("./","")}`,data:s.contents}))),a.push(...e.componentModules.map(s=>({path:`src/routes/${s.title.replace("../","")}`,data:s.contents}))),a.push(...e.componentComponents.map(s=>({path:`src/routes/${s.title}`,data:s.contents}))),a.push(...e.csvs.map(s=>({path:`src/routes/${s.title.replace("../","")}`,data:s.contents}))),a.push(...e.jsons.map(s=>({path:`src/routes/${s.title.replace("../","")}`,data:s.contents}))),a.push({path:"src/routes/+page.svelte",data:e.main.contents});const j=E(a.filter(Boolean),"path",!1);z(A(j),`layercake-${c?"ssr-":""}${p}.zip`),o(0,i=!1)}return l.$$set=n=>{"data"in n&&o(2,e=n.data),"slug"in n&&o(3,p=n.slug),"ssr"in n&&o(4,c=n.ssr)},[i,b,e,p,c]}class W extends N{constructor(t){super(),q(this,t,L,I,_,{data:2,slug:3,ssr:4})}}function G(l){const t=l.split("/"),o=t[t.length-1].split(".");return o.pop(),o.join(".").toLowerCase()}export{W as D,G as c};
